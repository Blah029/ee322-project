MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;-------------------------------------------------------------------------------
                      00002 ; EE322 Embedded Systems Design
                      00003 ; Year 3 Semester 1
                      00004 ; Group Project
                      00005 ; Title: Coin Sorter and Calculator
                      00006 ; 
                      00007 ; Group G1
                      00008 ;    E/17/146: Jayawickrama, J.P.D.D.M.
                      00009 ;    E/17/234: Pandukabhaya, V.K.M.
                      00010 ;    E/17/371: Warnakulasuriya, R.
                      00011 ;-------------------------------------------------------------------------------
                      00012 
                      00013 ;-------------------------------------------------------------------------------
                      00014 ; Header
                      00015 #include <p16f84a.inc>                  ; Include file for register names
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Nov 22 2017
                      00005 ;  MPASM PIC16F84A processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2017 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00209         LIST
                      00016         list        p = 16f84a          ; Microcontroller model
                      00017 ;-------------------------------------------------------------------------------
                      00018 
                      00019 ;-------------------------------------------------------------------------------
                      00020 ; Pin Designations
                      00021 ; * RA0: Servo Motor 1 (COIN_GATE)
                      00022 ; * RA1: Servo Motor 2 (ROTATE)
                      00023 ; * RA2: Servo Motor 3 (TILT)
                      00024 ; * RB0: Connected to DOUT (Data line Out) of HX711 module
                      00025 ; * RA3: Connected to  SCK  (Serial Clock) of HX711 module
                      00026 ;-------------------------------------------------------------------------------
                      00027 
                      00028 ;-------------------------------------------------------------------------------
                      00029 ; GPRs
                      00030 ; Counter variables for delays (all delays)
  0000000C            00031 count1  equ         0x0c                ; used in a decfsz
  0000000D            00032 count2  equ         0x0d                ; used in a decfsz
  0000000E            00033 count3  equ         0x0e                ; used in a decfsz
                      00034 
                      00035 ; A variable to store the bit index currently being read from the ADC
                      00036 ; of HX711
  0000000F            00037 BitIdx  equ         0x0f                
                      00038 
                      00039 ; Three 8-bit registers to store the incoming 24-bit number from
                      00040 ; the ADC of HX711.        Arrangement: [00000000,00000000,00000000]
                      00041 ;                                       [  Byte2 ,  Byte1 ,  Byte0 ]
  00000010            00042 Byte2   equ         0x10
  00000011            00043 Byte1   equ         0x11
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000012            00044 Byte0   equ         0x12
                      00045 
                      00046 ; Flag register: to store bits corresponding to specific purposes
                      00047 ; Bit 0: EOC (0: Not EOC, 1: EOC)
  00000014            00048 Flags   equ         0x14
                      00049 
                      00050 ; Other
  00000015            00051 tmp1    equ         0x15                                                            ; temporary register
                            ; delete later
                      00052 ;-------------------------------------------------------------------------------
                      00053 
                      00054 ;-------------------------------------------------------------------------------
                      00055 ; Constants
                      00056                                                                                     ; Constants for weig
                            ht thresholds
                      00057                                                                                     ; Set the values of 
                            GPRs at INIT
                      00058 ;-------------------------------------------------------------------------------
                      00059 
                      00060 ;-------------------------------------------------------------------------------
                      00061 ; Define origin and interrupt vectors
                      00062         org         0x000               ; Origin vector
0000   2???           00063         goto        INIT
                      00064         
                      00065         org         0x04                ; Interrupt vector
0004   2???           00066         goto        ISR_ADC_READY       ; Go to ISR_ADC_READY
                      00067 ;-------------------------------------------------------------------------------
                      00068 
                      00069 ;-------------------------------------------------------------------------------
                      00070 ; Routine "INIT"
                      00071 ;       Executed once. Configures general settings in PIC.
                      00072 
0005                  00073 INIT:
0005   1683           00074         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
                      00075         
                      00076 ; Set Interrupt Settings
0006   160B           00077         bsf         INTCON, INTE        ; Enable the RB0/INT interrupt
                      00078         
0007   138B           00079         bcf         INTCON, GIE         ; Disable all un-masked (global)
                      00080                                         ; interrupts (turn this on only
                      00081                                         ; when needed)
                      00082                                         
0008   108B           00083         bcf         INTCON, INTF        ; Clear the RB0/INT flag
                      00084         
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   1301           00085         bcf         OPTION_REG, INTEDG  ; Interrupt on falling edge of
                      00086                                         ; RB0/INT pin (required by HX711)
                      00087                                         ; Falling edge = ADC is ready to
                      00088                                         ;                transmit data
                      00089                                         
                      00090 ; Set PORTA, PORTB pin modes (default)
000A   3001           00091         movlw       b'00000001'         ; PORTB I/O pattern
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B   0086           00092         movwf       TRISB               ; Set PORTB pin modes
                      00093         
000C   3000           00094         movlw       b'00000000'         ; PORTA I/O pattern
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   0085           00095         movwf       TRISA               ; Set PORTA pin modes
                      00096         
000E   1283           00097         bcf         STATUS, RP0         ; Bank 0 select
                      00098 
                      00099 ; Reset flags (clear all)
000F   0194           00100         clrf        Flags               ; User-defined flags
                      00101         
                      00102 ; Initialize PORTA and PORTB                                                        ; See whether this w
                            ill be needed later
                      00103         ;movlw       b'00000000'         ; All zeros
                      00104         ;movwf       PORTB
                      00105         ;movlw       b'00000000'         ; All zeros
                      00106         ;movwf       PORTA
                      00107         
                      00108 ; Initialize positions of the three motors to zero        
0010   3007           00109         movlw       b'00000111'         ; Turn on RA0, RA1, RA2
0011   0085           00110         movwf       PORTA               ; 
0012   2???           00111         call        MOTOR_0_ON          ;
                      00112         
0013   3000           00113         movlw       b'00000000'         ; Turn off RA0, RA1, RA2
0014   0085           00114         movwf       PORTA               ; 
0015   2???           00115         call        MOTOR_0_OFF         ;
                      00116 
                      00117 ; Finally switch to the MAIN routine
0016   2???           00118         call        MAIN
                      00119         
                      00120 ;-------------------------------------------------------------------------------
                      00121         
                      00122 ;-------------------------------------------------------------------------------
                      00123 ; MAIN: Main routine
0017                  00124 MAIN:
0017   2???           00125         call        READ_FROM_ADC       ; Read a raw value from ADC
                      00126         
0018   1585           00127         bsf         PORTA, RA3          ; ADC: Power down mode
0019   2???           00128         call        DELAY_100us         ;
                      00129         
                      00130         ; Display the read bits
001A   0810           00131         movf        Byte2, W            ; Byte2
001B   0095           00132         movwf       tmp1                ;
001C   2???           00133         call        _DISP_BITS          ;
001D   2???           00134         call        DELAY_1S            ;
                      00135         
001E   0811           00136         movf        Byte1, W            ; Byte1
001F   0095           00137         movwf       tmp1                ;
0020   2???           00138         call        _DISP_BITS          ;
0021   2???           00139         call        DELAY_1S            ;
                      00140         
0022   0812           00141         movf        Byte0, W            ; Byte0
0023   0095           00142         movwf       tmp1                ;
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0024   2???           00143         call        _DISP_BITS          ;
0025   2???           00144         call        DELAY_1S            ;
                      00145         
0026   3000           00146         movlw       b'00000000'         ; Display zero
0027   0095           00147         movwf       tmp1                ;
0028   2???           00148         call        _DISP_BITS          ;
0029   2???           00149         call        DELAY_1S            ;
                      00150         
002A   1185           00151         bcf         PORTA, RA3          ; ADC: Power up mode
                      00152         
002B                  00153 PROCESS_DATA:
                      00154         ; Process Byte2, Byte1, Byte0
                      00155                                                                                     ; Do the rest
                      00156         
002B   2???           00157         goto        MAIN
                      00158 ;-------------------------------------------------------------------------------
                      00159 
                      00160 ;-------------------------------------------------------------------------------
002C                  00161 _DISP_BITS:                                                                         ; temporary function
                             to display a register
002C   1205           00162         bcf         PORTA, RA4                                                      ; delete later
002D   1815           00163         btfsc       tmp1, 0
002E   1605           00164         bsf         PORTA, RA4
                      00165         
002F   1086           00166         bcf         PORTB, RB1
0030   1895           00167         btfsc       tmp1, 1
0031   1486           00168         bsf         PORTB, RB1
                      00169         
0032   1106           00170         bcf         PORTB, RB2
0033   1915           00171         btfsc       tmp1, 2
0034   1506           00172         bsf         PORTB, RB2
                      00173         
0035   1186           00174         bcf         PORTB, RB3
0036   1995           00175         btfsc       tmp1, 3
0037   1586           00176         bsf         PORTB, RB3
                      00177         
0038   1206           00178         bcf         PORTB, RB4
0039   1A15           00179         btfsc       tmp1, 4
003A   1606           00180         bsf         PORTB, RB4
                      00181         
003B   1286           00182         bcf         PORTB, RB5
003C   1A95           00183         btfsc       tmp1, 5
003D   1686           00184         bsf         PORTB, RB5
                      00185         
003E   1306           00186         bcf         PORTB, RB6
003F   1B15           00187         btfsc       tmp1, 6
0040   1706           00188         bsf         PORTB, RB6
                      00189         
0041   1386           00190         bcf         PORTB, RB7
0042   1B95           00191         btfsc       tmp1, 7
0043   1786           00192         bsf         PORTB, RB7
                      00193         
0044   0008           00194         return
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00195 ;-------------------------------------------------------------------------------
                      00196         
                      00197 ;-------------------------------------------------------------------------------
                      00198 ; READ_FROM_ADC: Read a 24-bit raw value from the HX711 module
0045                  00199 READ_FROM_ADC:
0045   1683           00200         bsf         STATUS, RP0         ; Switch to Bank 1 (bit 5)
                      00201         
0046   138B           00202         bcf         INTCON, GIE         ; Disable all un-masked (global)
                      00203                                         ; interrupts (turn this on only
                      00204                                         ; when needed)
                      00205                                         
0047   108B           00206         bcf         INTCON, INTF        ; Clear the RB0/INT flag
0048   1283           00207         bcf         STATUS, RP0         ; Bank 0 select
                      00208         
0049                  00209 SOC: ; Start of conversion
0049   3019           00210         movlw       d'25'               ; Reset the bit index to 25
004A   008F           00211         movwf       BitIdx              ; (to count 24 bits)
                      00212         
004B   0190           00213         clrf        Byte2               ; Clear Byte2 register
004C   0191           00214         clrf        Byte1               ; Clear Byte2 register
004D   0192           00215         clrf        Byte0               ; Clear Byte2 register
                      00216         
                      00217 ;        movlw       d'0'                ; Reset the 24-bit number                   ; CORRECTION: USE C
                            LEAR INSTRUCTION
                      00218 ;        movwf       Byte2               ; Byte2
                      00219 ;        movlw       d'0'
                      00220 ;        movwf       Byte1               ; Byte1
                      00221 ;        movlw       d'0'
                      00222 ;        movwf       Byte0               ; Byte0
                      00223         
                      00224         ;bcf         STATUS, RP0         ; Switch to Bank 0 (bit 5)                  ; COMMENTED: DUPLIC
                            ATE
                      00225         
                      00226 ; Turn on the ADC
004E   3000           00227         movlw       b'00000000'         ; SCK: 0 (Clear SCK line)
004F   0085           00228         movwf       PORTA               ; RA0, RA1                              
                      00229         
0050   3001           00230         movlw       b'00000001'         ; DOUT: 1 (Set this to 1.               
                      00231                                         ; Interrupt will then trigger
0051   0086           00232         movwf       PORTB               ; at a falling edge of this pin)
                      00233         
0052   1014           00234         bcf         Flags, 0            ; Clear EOC flag
                      00235         
0053   1683           00236         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
0054   178B           00237         bsf         INTCON, GIE         ; Enable GIE to make the
                      00238                                         ; RB0 pin an interrupt pin
0055   1283           00239         bcf         STATUS, RP0         ; Bank 0 select (bit 5)
                      00240 
                      00241 ; Wait until ADC is ready (i.e. wait until RB0 is falling-edge triggered)
0056                  00242 IDLE_STATE:
0056   1C14           00243         btfss       Flags, 0            ; Check if the EOC flag is set
0057   2???           00244         goto        IDLE_STATE          ; Go to the MAIN routine again (loop)
                      00245 
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0058                  00246 EOC: ; End of conversion
0058   0008           00247         return                          ; If EOC flag is set, then a single
                      00248                                         ; read cycle is completed. Go back
                      00249                                         ; to the MAIN routine.
                      00250 ;-------------------------------------------------------------------------------
                      00251 
                      00252 ;-------------------------------------------------------------------------------
                      00253 ; ISR_ADC_READY: Occurs when ADC is ready to send data
0059                  00254 ISR_ADC_READY:
0059   1683           00255         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
005A   138B           00256         bcf         INTCON, GIE         ; Disable GIE to make the RB0 pin
                      00257                                         ; temporarily an input
005B   1283           00258         bcf         STATUS, RP0         ; Bank 0 select (bit 5)
                      00259 
005C                  00260 BIT_READ_LOOP:
005C   0B8F           00261         decfsz      BitIdx, f           ; Decrement the current bit index
005D   2???           00262         goto        ADC_READ_BIT        ; Get the latest bit from the ADC
                      00263 
005E                  00264 BIT_READ_END:
005E   1414           00265         bsf         Flags, 0            ; Set EOC flag to mark the EOC
                      00266 
                      00267 ; Post-processing of received data
005F                  00268 POST_PROC:
                      00269 ; XOR the raw output
005F   3008           00270         movlw       b'00001000'         ; Turn on the SCK pin of HX711
0060   0085           00271         movwf       PORTA               ; 
0061   0000           00272         nop
                      00273         
0062   0810           00274         movf        Byte2, W            ;                                           ; Reason for XORing?
0063   3A80           00275         xorlw       b'10000000'         ; XOR Byte2 with 0x80 (10000000)
0064   0090           00276         movwf       Byte2               ; 
                      00277         
0065   0811           00278         movf        Byte1, W            ; 
0066   3A00           00279         xorlw       b'00000000'         ; XOR Byte1 with 0x00 (00000000)
0067   0091           00280         movwf       Byte1               ;
                      00281         
0068   0812           00282         movf        Byte0, W            ;
0069   3A00           00283         xorlw       b'00000000'         ; XOR Byte0 with 0x00 (00000000)
006A   0092           00284         movwf       Byte0               ;
                      00285         
006B   3000           00286         movlw       b'00000000'         ; Turn off the SCK pin of HX711
006C   0085           00287         movwf       PORTA               ;
006D   0000           00288         nop                             ;
                      00289         
006E   0008           00290         return                          ; Return from ISR_ADC_READY
                      00291                                         ; Goes back to IDLE_STATE (EOC)
                      00292 ;-------------------------------------------------------------------------------
                      00293 
                      00294 ;-------------------------------------------------------------------------------
                      00295 ; ADC_READ_BIT: Read a bit from the ADC
006F                  00296 ADC_READ_BIT:
                      00297 
                      00298 ; Left-shift Byte2, Byte1 and Byte0 by one bit
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006F   0D92           00299         rlf         Byte0, f            ; Left-shift Byte0
0070   0D91           00300         rlf         Byte1, f            ; Left-shift Byte1
0071   0D90           00301         rlf         Byte2, f            ; Left-shift Byte2
                      00302         
                      00303         
                      00304     
                      00305 ;        rlf         Byte2, f            ; Left-shift Byte2
                      00306 ;        
                      00307 ;        bcf         Byte2, 0            ; Clear the LSB of Byte2
                      00308 ;        
                      00309 ;        rlf         Byte1, f            ; Left-shift Byte1
                      00310 ;        
                      00311 ;        btfsc       STATUS, C           ; Get the carry bit of Byte1 after
                      00312 ;                                        ; Left-shifting
                      00313 ;                                        
                      00314 ;        bsf         Byte2, 0            ; Set the LSB of Byte2 equal to the
                      00315 ;                                        ; carry of Byte1
                      00316 ;        
                      00317 ;        rlf         Byte0, f            ; Left-shift Byte0
                      00318 ;        
                      00319 ;        bcf         Byte1, 0            ; Clear the LSB of Byte1
                      00320 ;        
                      00321 ;        btfsc       STATUS, C           ; Get the carry bit of Byte0 after
                      00322 ;                                        ; Left-shifting
                      00323 ;                                        
                      00324 ;        bsf         Byte1, 0            ; Set the LSB of Byte1 equal to the
                      00325 ;                                        ; carry of Byte0
                      00326                                         
                      00327                                         
                      00328         
0072   1012           00329         bcf         Byte0, 0            ; Clear the LSB of Byte0
                      00330                                         
                      00331 ; Get the incoming bit and assign it to the LSB of Byte0
                      00332 ; Apply a clock pulse
0073   3008           00333         movlw       b'00001000'         ; Turn on the SCK pin of HX711
0074   0085           00334         movwf       PORTA               ;
0075   0000           00335         nop
                      00336         
0076   3000           00337         movlw       b'00000000'         ; Turn off the SCK pin of HX711
0077   0085           00338         movwf       PORTA
0078   0000           00339         nop
                      00340         
0079   1806           00341         btfsc       PORTB, RB0          ; Capture the incoming bit from the
                      00342                                         ; ADC by checking whether it is 1
                      00343         
007A   1412           00344         bsf         Byte0, 0            ; Set the LSB of the 24-bit number
                      00345                                         ; with the new bit (if it is 1)
                      00346         
007B   2???           00347         goto        BIT_READ_LOOP
                      00348 ;-------------------------------------------------------------------------------
                      00349 
                      00350 ;-------------------------------------------------------------------------------
                      00351 ; DELAY: Generic delay subroutine
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00352 ; T = 18 + (count1-1)*3 + (count2-1)*770 + (count3-1)*197140 ns
007C                  00353 DELAY
007C   0B8C           00354         decfsz      count1, f
007D   2???           00355         goto        DELAY
                      00356         
007E   0B8D           00357         decfsz      count2, f
007F   2???           00358         goto        DELAY
                      00359         
0080   0B8E           00360         decfsz      count3, f
0081   2???           00361         goto        DELAY
                      00362         
0082   0008           00363         return
                      00364 ;-------------------------------------------------------------------------------
                      00365 
                      00366 ;-------------------------------------------------------------------------------
                      00367 ; Motor Controller subroutines
0083                  00368 MOTOR_PLUS90_ON:
0083   3095           00369         movlw       d'149'              ; set layer 1 delay counter
0084   008C           00370         movwf       count1              ; 
0085   3003           00371         movlw       d'3'                ; set layer 2 delay counter
0086   008D           00372         movwf       count2              ; 
0087   3001           00373         movlw       d'1'                ; set layer 3 delay counter
0088   008E           00374         movwf       count3              ; 
0089   2???           00375         call        DELAY               ; keep the set-up delay
                      00376         
008A   0008           00377         return
                      00378         
008B                  00379 MOTOR_PLUS90_OFF:
008B   3001           00380         movlw       d'1'                ; set layer 1 delay counter
008C   008C           00381         movwf       count1              ; 
008D   3001           00382         movlw       d'1'                ; set layer 2 delay counter
008E   008D           00383         movwf       count2              ; 
008F   3003           00384         movlw       d'3'                ; set layer 3 delay counter
0090   008E           00385         movwf       count3              ; 
0091   2???           00386         call        DELAY               ; keep the set-up delay
                      00387         
0092   0008           00388         return
                      00389 
0093                  00390 MOTOR_0_ON:
0093   30EE           00391         movlw       d'238'              ; set layer 1 delay counter
0094   008C           00392         movwf       count1              ; 
0095   3002           00393         movlw       d'2'                ; set layer 2 delay counter
0096   008D           00394         movwf       count2              ; 
0097   3001           00395         movlw       d'1'                ; set layer 3 delay counter
0098   008E           00396         movwf       count3              ; 
0099   2???           00397         call        DELAY               ; keep the set-up delay
                      00398         
009A   0008           00399         return
                      00400         
009B                  00401 MOTOR_0_OFF:
009B   30A1           00402         movlw       d'161'              ; set layer 1 delay counter
009C   008C           00403         movwf       count1              ; 
009D   3001           00404         movlw       d'1'                ; set layer 2 delay counter
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

009E   008D           00405         movwf       count2              ; 
009F   3001           00406         movlw       d'1'                ; set layer 3 delay counter
00A0   008E           00407         movwf       count3              ; 
00A1   2???           00408         call        DELAY               ; keep the set-up delay
                      00409         
00A2   0008           00410         return
                      00411         
00A3                  00412 MOTOR_MINUS30_ON:
00A3   30B7           00413         movlw       d'183'              ; set layer 1 delay counter
00A4   008C           00414         movwf       count1              ; 
00A5   3002           00415         movlw       d'2'                ; set layer 2 delay counter
00A6   008D           00416         movwf       count2              ; 
00A7   3001           00417         movlw       d'1'                ; set layer 3 delay counter
00A8   008E           00418         movwf       count3              ; 
00A9   2???           00419         call        DELAY               ; keep the set-up delay
                      00420         
00AA   0008           00421         return
                      00422         
00AB                  00423 MOTOR_MINUS30_OFF:
00AB   30D9           00424         movlw       d'217'              ; set layer 1 delay counter
00AC   008C           00425         movwf       count1              ; 
00AD   3001           00426         movlw       d'1'                ; set layer 2 delay counter
00AE   008D           00427         movwf       count2              ; 
00AF   3001           00428         movlw       d'1'                ; set layer 3 delay counter
00B0   008E           00429         movwf       count3              ; 
00B1   2???           00430         call        DELAY               ; keep the set-up delay
                      00431         
00B2   0008           00432         return
                      00433 
00B3                  00434 MOTOR_PLUS30_ON:
00B3   3025           00435         movlw       d'37'               ; set layer 1 delay counter
00B4   008C           00436         movwf       count1              ; 
00B5   3003           00437         movlw       d'3'                ; set layer 2 delay counter
00B6   008D           00438         movwf       count2              ; 
00B7   3001           00439         movlw       d'1'                ; set layer 3 delay counter
00B8   008E           00440         movwf       count3              ; 
00B9   2???           00441         call        DELAY               ; keep the set-up delay
                      00442         
00BA   0008           00443         return
                      00444         
00BB                  00445 MOTOR_PLUS30_OFF:
00BB   306A           00446         movlw       d'106'              ; set layer 1 delay counter
00BC   008C           00447         movwf       count1              ; 
00BD   3001           00448         movlw       d'1'                ; set layer 2 delay counter
00BE   008D           00449         movwf       count2              ; 
00BF   3001           00450         movlw       d'1'                ; set layer 3 delay counter
00C0   008E           00451         movwf       count3              ; 
00C1   2???           00452         call        DELAY               ; keep the set-up delay
                      00453         
00C2   0008           00454         return
                      00455         
00C3                  00456 DELAY_1S:
00C3   308E           00457         movlw       d'142'              ; set layer 1 delay counter
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C4   008C           00458         movwf       count1              ; 
00C5   3013           00459         movlw       d'19'               ; set layer 2 delay counter
00C6   008D           00460         movwf       count2              ; 
00C7   3006           00461         movlw       d'6'                ; set layer 3 delay counter
00C8   008E           00462         movwf       count3              ; 
00C9   2???           00463         call        DELAY               ; keep the set-up delay
                      00464         
00CA   0008           00465         return
                      00466 
00CB                  00467 DELAY_100us: ; For ADC power off
00CB   301C           00468         movlw       d'28'               ; set layer 1 delay counter
00CC   008C           00469         movwf       count1              ; 
00CD   3001           00470         movlw       d'1'                ; set layer 2 delay counter
00CE   008D           00471         movwf       count2              ; 
00CF   3001           00472         movlw       d'1'                ; set layer 3 delay counter
00D0   008E           00473         movwf       count3              ; 
00D1   2???           00474         call        DELAY               ; keep the set-up delay
                      00475         
00D2   0008           00476         return
                      00477 
                      00478 ;-------------------------------------------------------------------------------
                      00479 
00D3                  00480 INF_LOOP:
00D3   2???           00481         goto    $
                      00482 
                      00483 ;-------------------------------------------------------------------------------
                      00484 
                      00485 ;-------------------------------------------------------------------------------
                      00486         end
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE 11


SYMBOL TABLE
  LABEL                             VALUE 

ADC_READ_BIT                      0000006F
BIT_READ_END                      0000005E
BIT_READ_LOOP                     0000005C
BitIdx                            0000000F
Byte0                             00000012
Byte1                             00000011
Byte2                             00000010
C                                 00000000
DC                                00000001
DELAY                             0000007C
DELAY_100us                       000000CB
DELAY_1S                          000000C3
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
EOC                               00000058
F                                 00000001
FSR                               00000004
Flags                             00000014
GIE                               00000007
IDLE_STATE                        00000056
INDF                              00000000
INF_LOOP                          000000D3
INIT                              00000005
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
ISR_ADC_READY                     00000059
MAIN                              00000017
MOTOR_0_OFF                       0000009B
MOTOR_0_ON                        00000093
MOTOR_MINUS30_OFF                 000000AB
MOTOR_MINUS30_ON                  000000A3
MOTOR_PLUS30_OFF                  000000BB
MOTOR_PLUS30_ON                   000000B3
MOTOR_PLUS90_OFF                  0000008B
MOTOR_PLUS90_ON                   00000083
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
OPTION_REG                        00000081
PCL                               00000002
PCLATH                            0000000A
PORTA                             00000005
PORTB                             00000006
POST_PROC                         0000005F
PROCESS_DATA                      0000002B
PS0                               00000000
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

PS1                               00000001
PS2                               00000002
PSA                               00000003
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RD                                00000000
READ_FROM_ADC                     00000045
RP0                               00000005
RP1                               00000006
SOC                               00000049
STATUS                            00000003
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_.org_1_00D3                      000000D3
_CONFIG                           00002007
MPASM 5.77                      MAINCODE.ASM   9-22-2021  17:55:54         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

_CP_OFF                           00003FFF
_CP_ON                            0000000F
_DEVID1                           00002006
_DISP_BITS                        0000002C
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84A                          00000001
count1                            0000000C
count2                            0000000D
count3                            0000000E
tmp1                              00000015

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     3 reported,     0 suppressed

