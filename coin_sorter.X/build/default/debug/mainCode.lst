MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;-------------------------------------------------------------------------------
                      00002 ; EE322 Embedded Systems Design
                      00003 ; Year 3 Semester 1
                      00004 ; Group Project
                      00005 ; Title: Coin Sorter and Calculator
                      00006 ; 
                      00007 ; Group G1
                      00008 ;    E/17/146: Jayawickrama, J.P.D.D.M.
                      00009 ;    E/17/234: Pandukabhaya, V.K.M.
                      00010 ;    E/17/371: Warnakulasuriya, R.
                      00011 ;-------------------------------------------------------------------------------
                      00012 
                      00013 ;-------------------------------------------------------------------------------
                      00014 ; Header
                      00015 #include <p16f84a.inc>                  ; Include file for register names
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Nov 22 2017
                      00005 ;  MPASM PIC16F84A processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2017 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00209         LIST
                      00016         list        p = 16f84a          ; Microcontroller model
                      00017 ;-------------------------------------------------------------------------------
                      00018 
                      00019 ;-------------------------------------------------------------------------------
                      00020 ; Pin Designations
                      00021 ; * RA0: Servo Motor 1
                      00022 ; * RA1: Servo Motor 2
                      00023 ; * RA2: Servo Motor 3
                      00024 ; * RA3: Connected to DOUT (Data line Out) of HX711 module
                      00025 ; * RB0: Connected to  SCK  (Serial Clock) of HX711 module
                      00026 ;-------------------------------------------------------------------------------
                      00027 
                      00028 ;-------------------------------------------------------------------------------
                      00029 ; GPRs
                      00030 ; Counter variables for delays (all delays)
  0000000C            00031 count1  equ         0x0c                ; used in a decfsz
  0000000D            00032 count2  equ         0x0d                ; used in a decfsz
  0000000E            00033 count3  equ         0x0e                ; used in a decfsz
                      00034 
                      00035 ; A variable to store the bit index currently being read from the ADC
                      00036 ; of HX711
  0000000F            00037 BitIdx  equ         0x0f                
                      00038 
                      00039 ; Three 8-bit registers to store the incoming 24-bit number from
                      00040 ; the ADC of HX711.        Arrangement: [00000000,00000000,00000000]
                      00041 ;                                       [  Byte2 ,  Byte1 ,  Byte0 ]
  00000010            00042 Byte2   equ         0x10
  00000011            00043 Byte1   equ         0x11
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000012            00044 Byte0   equ         0x12
                      00045 
                      00046 ; Flag register: to store bits corresponding to specific purposes
                      00047 ; Bit 0: EOC (0: Not EOC, 1: EOC)
  00000014            00048 Flags   equ         0x14
                      00049 
                      00050 ; Other
  00000015            00051 tmp1    equ         0x15                                                            ; temporary register
                            ; delete later
                      00052 ;-------------------------------------------------------------------------------
                      00053 
                      00054 ;-------------------------------------------------------------------------------
                      00055 ; Constants
                      00056                                                                                     ; Constants for weig
                            ht thresholds
                      00057                                                                                     ; Set the values of 
                            GPRs at INIT
                      00058 ;-------------------------------------------------------------------------------
                      00059 
                      00060 ;-------------------------------------------------------------------------------
                      00061 ; Define origin and interrupt vectors
                      00062         org         0x000               ; Origin vector
0000   2???           00063         goto        INIT
                      00064         
                      00065         org         0x04                ; Interrupt vector
0004   2???           00066         goto        ISR_ADC_READY       ; Go to ISR_ADC_READY
                      00067 ;-------------------------------------------------------------------------------
                      00068 
                      00069 ;-------------------------------------------------------------------------------
                      00070 ; Routine "INIT"
                      00071 ;       Executed once. Configures general settings in PIC.
                      00072 
0005                  00073 INIT:
0005   1683           00074         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
                      00075         
                      00076 ; Set Interrupt Settings
0006   160B           00077         bsf         INTCON, INTE        ; Enable the RB0/INT interrupt
                      00078         
0007   178B           00079         bsf         INTCON, GIE         ; Disable all un-masked (global)
                      00080                                         ; interrupts (turn this on only
                      00081                                         ; when needed)
                      00082                                         
0008   108B           00083         bcf         INTCON, INTF        ; Clear the RB0/INT flag
                      00084         
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   1301           00085         bcf         OPTION_REG, INTEDG  ; Interrupt on falling edge of
                      00086                                         ; RB0/INT pin (required by HX711)
                      00087                                         ; Falling edge = ADC is ready to
                      00088                                         ;                transmit data
                      00089                                         
                      00090 ; Set PORTA, PORTB pin modes (default)
000A   3001           00091         movlw       b'00000001'         ; PORTB I/O pattern
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B   0086           00092         movwf       TRISB               ; Set PORTB pin modes
                      00093         
000C   3000           00094         movlw       b'00000000'         ; PORTA I/O pattern
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   0085           00095         movwf       TRISA               ; Set PORTA pin modes
                      00096         
000E   1283           00097         bcf         STATUS, RP0         ; Bank 0 select
                      00098 
                      00099 ; Reset flags (clear all)
000F   0194           00100         clrf        Flags               ; User-defined flags
                      00101         
                      00102 ; Initialize PORTA and PORTB                                                        ; See whether this w
                            ill be needed later
                      00103         ;movlw       b'00000000'         ; All zeros
                      00104         ;movwf       PORTB
                      00105         ;movlw       b'00000000'         ; All zeros
                      00106         ;movwf       PORTA
                      00107         
                      00108 ; Initialize positions of the three motors to zero        
0010   3007           00109         movlw       b'00000111'         ; Turn on RA0, RA1, RA2
0011   0085           00110         movwf       PORTA               ; 
0012   2???           00111         call        MOTOR_0_ON          ;
                      00112         
0013   3000           00113         movlw       b'00000000'         ; Turn off RA0, RA1, RA2
0014   0085           00114         movwf       PORTA               ; 
0015   2???           00115         call        MOTOR_0_OFF         ;
                      00116 
                      00117 ; Finally switch to the MAIN routine
0016   2???           00118         call        MAIN
                      00119         
                      00120 ;-------------------------------------------------------------------------------
                      00121         
                      00122 ;-------------------------------------------------------------------------------
                      00123 ; MAIN: Main routine
0017                  00124 MAIN:
0017   2???           00125         call        READ_FROM_ADC       ; Read a raw value from ADC
                      00126         
0018   1585           00127         bsf         PORTA, RA3          ; Turn off ADC
0019   2???           00128         call        DELAY_100us         ;
                      00129         
                      00130         ; Display the read bits
001A   0810           00131         movf        Byte2, W            ; Byte2
001B   0095           00132         movwf       tmp1                ;
001C   2???           00133         call        _DISP_BITS          ;
001D   2???           00134         call        DELAY_1S            ;
                      00135         
001E   0811           00136         movf        Byte1, W            ; Byte1
001F   0095           00137         movwf       tmp1                ;
0020   2???           00138         call        _DISP_BITS          ;
0021   2???           00139         call        DELAY_1S            ;
                      00140         
0022   0812           00141         movf        Byte0, W            ; Byte0
0023   0095           00142         movwf       tmp1                ;
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0024   2???           00143         call        _DISP_BITS          ;
0025   2???           00144         call        DELAY_1S            ;
                      00145         
0026   3000           00146         movlw       b'00000000'         ; Display zero
0027   0095           00147         movwf       tmp1                ;
0028   2???           00148         call        _DISP_BITS          ;
0029   2???           00149         call        DELAY_1S            ;
                      00150         
002A   1185           00151         bcf         PORTA, RA3          ; Resume ADC
                      00152         
002B                  00153 PROCESS_DATA:
                      00154         ; Process Byte2, Byte1, Byte0
                      00155                                                                                     ; Do the rest
                      00156         
002B   2???           00157         goto        MAIN
                      00158 ;-------------------------------------------------------------------------------
                      00159 
                      00160 ;-------------------------------------------------------------------------------
002C                  00161 _DISP_BITS:                                                                         ; temporary function
                             to display a register
002C   1205           00162         bcf         PORTA, RA4                                                      ; delete later
002D   1815           00163         btfsc       tmp1, 0
002E   1605           00164         bsf         PORTA, RA4
                      00165         
002F   1086           00166         bcf         PORTB, RB1
0030   1895           00167         btfsc       tmp1, 1
0031   1486           00168         bsf         PORTB, RB1
                      00169         
0032   1106           00170         bcf         PORTB, RB2
0033   1915           00171         btfsc       tmp1, 2
0034   1506           00172         bsf         PORTB, RB2
                      00173         
0035   1186           00174         bcf         PORTB, RB3
0036   1995           00175         btfsc       tmp1, 3
0037   1586           00176         bsf         PORTB, RB3
                      00177         
0038   1206           00178         bcf         PORTB, RB4
0039   1A15           00179         btfsc       tmp1, 4
003A   1606           00180         bsf         PORTB, RB4
                      00181         
003B   1286           00182         bcf         PORTB, RB5
003C   1A95           00183         btfsc       tmp1, 5
003D   1686           00184         bsf         PORTB, RB5
                      00185         
003E   1306           00186         bcf         PORTB, RB6
003F   1B15           00187         btfsc       tmp1, 6
0040   1706           00188         bsf         PORTB, RB6
                      00189         
0041   1386           00190         bcf         PORTB, RB7
0042   1B95           00191         btfsc       tmp1, 7
0043   1786           00192         bsf         PORTB, RB7
                      00193         
0044   0008           00194         return
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00195 ;-------------------------------------------------------------------------------
                      00196         
                      00197 ;-------------------------------------------------------------------------------
                      00198 ; READ_FROM_ADC: Read a 24-bit raw value from the HX711 module
0045                  00199 READ_FROM_ADC:
0045   1683           00200         bsf         STATUS, RP0         ; Switch to Bank 1 (bit 5)
                      00201         
0046   178B           00202         bsf         INTCON, GIE         ; Disable all un-masked (global)
                      00203                                         ; interrupts (turn this on only
                      00204                                         ; when needed)
                      00205                                         
0047   108B           00206         bcf         INTCON, INTF        ; Clear the RB0/INT flag
0048   1283           00207         bcf         STATUS, RP0         ; Bank 0 select
                      00208         
0049                  00209 SOC: ; Start of conversion
0049   3019           00210         movlw       d'25'               ; Reset the bit index to 25
004A   008F           00211         movwf       BitIdx              ; (to count 24 bits)
                      00212         
004B   3000           00213         movlw       d'0'                ; Reset the 24-bit number
004C   0090           00214         movwf       Byte2               ; Byte2
004D   3000           00215         movlw       d'0'
004E   0091           00216         movwf       Byte1               ; Byte1
004F   3000           00217         movlw       d'0'
0050   0092           00218         movwf       Byte0               ; Byte0
                      00219         
0051   1283           00220         bcf         STATUS, RP0         ; Switch to Bank 0 (bit 5)
                      00221         
0052   3000           00222         movlw       b'00000000'         ; SCK: 0 (Clear SCK line)               
0053   0085           00223         movwf       PORTA               ; RA0, RA1                              
                      00224         
0054   3001           00225         movlw       b'00000001'         ; DOUT: 1 (Set this to 1.               
                      00226                                         ; Interrupt will then trigger
0055   0086           00227         movwf       PORTB               ; at a falling edge of this pin)
                      00228         
0056   1014           00229         bcf         Flags, 0            ; Clear EOC flag
                      00230         
0057   1683           00231         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
0058   178B           00232         bsf         INTCON, GIE         ; Enable GIE to make the
                      00233                                         ; RB0 pin an interrupt pin
0059   1283           00234         bcf         STATUS, RP0         ; Bank 0 select (bit 5)
                      00235 
                      00236 ; Wait until ADC is ready (i.e. wait until RB0 is falling-edge triggered)
005A                  00237 IDLE_STATE:
005A   1C14           00238         btfss       Flags, 0            ; Check if the EOC flag is set
005B   2???           00239         goto        IDLE_STATE          ; Go to the MAIN routine again (loop)
                      00240 
005C                  00241 EOC: ; End of conversion
005C   0008           00242         return                          ; If EOC flag is set, then a single
                      00243                                         ; read cycle is completed. Go back
                      00244                                         ; to the MAIN routine.
                      00245 ;-------------------------------------------------------------------------------
                      00246 
                      00247 ;-------------------------------------------------------------------------------
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00248 ; ISR_ADC_READY: Occurs when ADC is ready to send data
005D                  00249 ISR_ADC_READY:
005D   1683           00250         bsf         STATUS, RP0         ; Bank 1 select (bit 5)
005E   138B           00251         bcf         INTCON, GIE         ; Disable GIE to make the RB0 pin
                      00252                                         ; temporarily an input
005F   1283           00253         bcf         STATUS, RP0         ; Bank 0 select (bit 5)
                      00254                                         
0060                  00255 BIT_READ_LOOP:
0060   0B8F           00256         decfsz      BitIdx, f           ; Decrement the current bit index
0061   2???           00257         goto        ADC_READ_BIT        ; Get the latest bit from the ADC
                      00258         
0062                  00259 BIT_READ_END:
0062   1414           00260         bsf         Flags, 0            ; Set EOC flag to mark the EOC
                      00261 
                      00262 ; Post-processing of received data
0063                  00263 POST_PROC:
                      00264 ; XOR the raw output
0063   3008           00265         movlw       b'00001000'         ; Turn on the SCK pin of HX711
0064   0085           00266         movwf       PORTA               ; 
0065   0000           00267         nop
                      00268         
0066   0810           00269         movf        Byte2, W            ;                                           ; Reason for XORing
0067   3A80           00270         xorlw       b'10000000'         ; XOR Byte2 with 0x80 (10000000)
0068   0090           00271         movwf       Byte2               ; 
                      00272         
0069   0811           00273         movf        Byte1, W            ; 
006A   3A00           00274         xorlw       b'00000000'         ; XOR Byte1 with 0x00 (00000000)
006B   0091           00275         movwf       Byte1               ;
                      00276         
006C   0812           00277         movf        Byte0, W            ;
006D   3A00           00278         xorlw       b'00000000'         ; XOR Byte0 with 0x00 (00000000)
006E   0092           00279         movwf       Byte0               ;
                      00280         
006F   3000           00281         movlw       b'00000000'         ; Turn off the SCK pin of HX711
0070   0085           00282         movwf       PORTA               ;
0071   0000           00283         nop                             ;
                      00284         
0072   0008           00285         return                          ; Return from ISR_ADC_READY
                      00286 ;-------------------------------------------------------------------------------
                      00287 
                      00288 ;-------------------------------------------------------------------------------
                      00289 ; ADC_READ_BIT: Read a bit from the ADC
0073                  00290 ADC_READ_BIT:
                      00291 
                      00292 ; Left-shift Byte2, Byte1 and Byte0 by one bit
0073   0D90           00293         rlf         Byte2, f            ; Left-shift Byte2
                      00294         
0074   1010           00295         bcf         Byte2, 0            ; Clear the LSB of Byte2
                      00296         
0075   0D91           00297         rlf         Byte1, f            ; Left-shift Byte1
                      00298         
0076   1803           00299         btfsc       STATUS, C           ; Get the carry bit of Byte1 after
                      00300                                         ; Left-shifting
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00301                                         
0077   1410           00302         bsf         Byte2, 0            ; Set the LSB of Byte2 equal to the
                      00303                                         ; carry of Byte1
                      00304         
0078   0D92           00305         rlf         Byte0, f            ; Left-shift Byte0
                      00306         
0079   1011           00307         bcf         Byte1, 0            ; Clear the LSB of Byte1
                      00308         
007A   1803           00309         btfsc       STATUS, C           ; Get the carry bit of Byte0 after
                      00310                                         ; Left-shifting
                      00311                                         
007B   1411           00312         bsf         Byte1, 0            ; Set the LSB of Byte1 equal to the
                      00313                                         ; carry of Byte0
                      00314         
007C   1012           00315         bcf         Byte0, 0            ; Clear the LSB of Byte0
                      00316                                         
                      00317 ; Get the incoming bit and assign it to the LSB of Byte0
                      00318 ; Apply a clock pulse
007D   3008           00319         movlw       b'00001000'         ; Turn on the SCK pin of HX711
007E   0085           00320         movwf       PORTA               ;
007F   0000           00321         nop
                      00322         
0080   3000           00323         movlw       b'00000000'         ; Turn off the SCK pin of HX711
0081   0085           00324         movwf       PORTA
0082   0000           00325         nop
                      00326         
0083   1806           00327         btfsc       PORTB, RB0          ; Capture the incoming bit from the
                      00328                                         ; ADC by checking whether it is 1
                      00329         
0084   1412           00330         bsf         Byte0, 0            ; Set the LSB of the 24-bit number
                      00331                                         ; with the new bit (if it is 1)
                      00332         
0085   2???           00333         goto        BIT_READ_LOOP
                      00334 ;-------------------------------------------------------------------------------
                      00335         
                      00336 ;-------------------------------------------------------------------------------
                      00337 ; DELAY: Generic delay subroutine
                      00338 ; T = 18 + (count1-1)*3 + (count2-1)*770 + (count3-1)*197140 ns
0086                  00339 DELAY
0086   0B8C           00340         decfsz      count1, f
0087   2???           00341         goto        DELAY
                      00342         
0088   0B8D           00343         decfsz      count2, f
0089   2???           00344         goto        DELAY
                      00345         
008A   0B8E           00346         decfsz      count3, f
008B   2???           00347         goto        DELAY
                      00348         
008C   0008           00349         return
                      00350 ;-------------------------------------------------------------------------------
                      00351 
                      00352 ;-------------------------------------------------------------------------------
                      00353 ; Motor Controller subroutines
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008D                  00354 MOTOR_PLUS90_ON:
008D   3095           00355         movlw       d'149'              ; set layer 1 delay counter
008E   008C           00356         movwf       count1              ; 
008F   3003           00357         movlw       d'3'                ; set layer 2 delay counter
0090   008D           00358         movwf       count2              ; 
0091   3001           00359         movlw       d'1'                ; set layer 3 delay counter
0092   008E           00360         movwf       count3              ; 
0093   2???           00361         call        DELAY               ; keep the set-up delay
                      00362         
0094   0008           00363         return
                      00364         
0095                  00365 MOTOR_PLUS90_OFF:
0095   3001           00366         movlw       d'1'                ; set layer 1 delay counter
0096   008C           00367         movwf       count1              ; 
0097   3001           00368         movlw       d'1'                ; set layer 2 delay counter
0098   008D           00369         movwf       count2              ; 
0099   3003           00370         movlw       d'3'                ; set layer 3 delay counter
009A   008E           00371         movwf       count3              ; 
009B   2???           00372         call        DELAY               ; keep the set-up delay
                      00373         
009C   0008           00374         return
                      00375 
009D                  00376 MOTOR_0_ON:
009D   30EE           00377         movlw       d'238'              ; set layer 1 delay counter
009E   008C           00378         movwf       count1              ; 
009F   3002           00379         movlw       d'2'                ; set layer 2 delay counter
00A0   008D           00380         movwf       count2              ; 
00A1   3001           00381         movlw       d'1'                ; set layer 3 delay counter
00A2   008E           00382         movwf       count3              ; 
00A3   2???           00383         call        DELAY               ; keep the set-up delay
                      00384         
00A4   0008           00385         return
                      00386         
00A5                  00387 MOTOR_0_OFF:
00A5   30A1           00388         movlw       d'161'              ; set layer 1 delay counter
00A6   008C           00389         movwf       count1              ; 
00A7   3001           00390         movlw       d'1'                ; set layer 2 delay counter
00A8   008D           00391         movwf       count2              ; 
00A9   3001           00392         movlw       d'1'                ; set layer 3 delay counter
00AA   008E           00393         movwf       count3              ; 
00AB   2???           00394         call        DELAY               ; keep the set-up delay
                      00395         
00AC   0008           00396         return
                      00397         
00AD                  00398 MOTOR_MINUS30_ON:
00AD   30B7           00399         movlw       d'183'              ; set layer 1 delay counter
00AE   008C           00400         movwf       count1              ; 
00AF   3002           00401         movlw       d'2'                ; set layer 2 delay counter
00B0   008D           00402         movwf       count2              ; 
00B1   3001           00403         movlw       d'1'                ; set layer 3 delay counter
00B2   008E           00404         movwf       count3              ; 
00B3   2???           00405         call        DELAY               ; keep the set-up delay
                      00406         
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B4   0008           00407         return
                      00408         
00B5                  00409 MOTOR_MINUS30_OFF:
00B5   30D9           00410         movlw       d'217'              ; set layer 1 delay counter
00B6   008C           00411         movwf       count1              ; 
00B7   3001           00412         movlw       d'1'                ; set layer 2 delay counter
00B8   008D           00413         movwf       count2              ; 
00B9   3001           00414         movlw       d'1'                ; set layer 3 delay counter
00BA   008E           00415         movwf       count3              ; 
00BB   2???           00416         call        DELAY               ; keep the set-up delay
                      00417         
00BC   0008           00418         return
                      00419 
00BD                  00420 MOTOR_PLUS30_ON:
00BD   3025           00421         movlw       d'37'               ; set layer 1 delay counter
00BE   008C           00422         movwf       count1              ; 
00BF   3003           00423         movlw       d'3'                ; set layer 2 delay counter
00C0   008D           00424         movwf       count2              ; 
00C1   3001           00425         movlw       d'1'                ; set layer 3 delay counter
00C2   008E           00426         movwf       count3              ; 
00C3   2???           00427         call        DELAY               ; keep the set-up delay
                      00428         
00C4   0008           00429         return
                      00430         
00C5                  00431 MOTOR_PLUS30_OFF:
00C5   306A           00432         movlw       d'106'              ; set layer 1 delay counter
00C6   008C           00433         movwf       count1              ; 
00C7   3001           00434         movlw       d'1'                ; set layer 2 delay counter
00C8   008D           00435         movwf       count2              ; 
00C9   3001           00436         movlw       d'1'                ; set layer 3 delay counter
00CA   008E           00437         movwf       count3              ; 
00CB   2???           00438         call        DELAY               ; keep the set-up delay
                      00439         
00CC   0008           00440         return
                      00441         
00CD                  00442 DELAY_1S:
00CD   308E           00443         movlw       d'142'              ; set layer 1 delay counter
00CE   008C           00444         movwf       count1              ; 
00CF   3013           00445         movlw       d'19'               ; set layer 2 delay counter
00D0   008D           00446         movwf       count2              ; 
00D1   3006           00447         movlw       d'6'                ; set layer 3 delay counter
00D2   008E           00448         movwf       count3              ; 
00D3   2???           00449         call        DELAY               ; keep the set-up delay
                      00450         
00D4   0008           00451         return
                      00452 
00D5                  00453 DELAY_100us: ; For ADC power off
00D5   301C           00454         movlw       d'28'               ; set layer 1 delay counter
00D6   008C           00455         movwf       count1              ; 
00D7   3001           00456         movlw       d'1'                ; set layer 2 delay counter
00D8   008D           00457         movwf       count2              ; 
00D9   3001           00458         movlw       d'1'                ; set layer 3 delay counter
00DA   008E           00459         movwf       count3              ; 
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00DB   2???           00460         call        DELAY               ; keep the set-up delay
                      00461         
00DC   0008           00462         return
                      00463 
                      00464 ;-------------------------------------------------------------------------------
                      00465 
00DD                  00466 INF_LOOP:
00DD   2???           00467         goto    $
                      00468 
                      00469 ;-------------------------------------------------------------------------------
                      00470 
                      00471 ;-------------------------------------------------------------------------------
                      00472         end
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE 11


SYMBOL TABLE
  LABEL                             VALUE 

ADC_READ_BIT                      00000073
BIT_READ_END                      00000062
BIT_READ_LOOP                     00000060
BitIdx                            0000000F
Byte0                             00000012
Byte1                             00000011
Byte2                             00000010
C                                 00000000
DC                                00000001
DELAY                             00000086
DELAY_100us                       000000D5
DELAY_1S                          000000CD
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
EOC                               0000005C
F                                 00000001
FSR                               00000004
Flags                             00000014
GIE                               00000007
IDLE_STATE                        0000005A
INDF                              00000000
INF_LOOP                          000000DD
INIT                              00000005
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
ISR_ADC_READY                     0000005D
MAIN                              00000017
MOTOR_0_OFF                       000000A5
MOTOR_0_ON                        0000009D
MOTOR_MINUS30_OFF                 000000B5
MOTOR_MINUS30_ON                  000000AD
MOTOR_PLUS30_OFF                  000000C5
MOTOR_PLUS30_ON                   000000BD
MOTOR_PLUS90_OFF                  00000095
MOTOR_PLUS90_ON                   0000008D
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
OPTION_REG                        00000081
PCL                               00000002
PCLATH                            0000000A
PORTA                             00000005
PORTB                             00000006
POST_PROC                         00000063
PROCESS_DATA                      0000002B
PS0                               00000000
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

PS1                               00000001
PS2                               00000002
PSA                               00000003
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RD                                00000000
READ_FROM_ADC                     00000045
RP0                               00000005
RP1                               00000006
SOC                               00000049
STATUS                            00000003
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_.org_1_00DD                      000000DD
_CONFIG                           00002007
MPASM 5.77                      MAINCODE.ASM   9-9-2021  18:58:11         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

_CP_OFF                           00003FFF
_CP_ON                            0000000F
_DEVID1                           00002006
_DISP_BITS                        0000002C
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84A                          00000001
__DEBUG                           
__MPLAB_DEBUGGER_SIMULATOR        1
count1                            0000000C
count2                            0000000D
count3                            0000000E
tmp1                              00000015

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     3 reported,     0 suppressed

